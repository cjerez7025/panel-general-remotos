<div class="dashboard-container">
  <!-- Header Mejorado -->
  <div class="dashboard-header">
    <div class="header-left">
      <h1>Panel General Remotos</h1>
      <div class="sync-status">
        <span class="sync-indicator" [ngClass]="loading ? 'syncing' : 'idle'"></span>
        <span class="sync-text">{{ loading ? 'Sincronizando...' : '√öltima sync: hace 5 min' }}</span>
      </div>
    </div>
    <div class="header-actions">
      <button class="btn-secondary" (click)="refreshData()" [disabled]="loading">
        <i class="icon">üîÑ</i>
        {{ loading ? 'Cargando...' : 'Actualizar' }}
      </button>
      <button class="btn-primary" (click)="forceRefresh()" [disabled]="loading">
        <i class="icon">‚ö°</i>
        Sincronizar
      </button>
    </div>
  </div>

  <!-- Breadcrumbs -->
  <nav class="breadcrumbs">
    <span class="breadcrumb-item active">Dashboard</span>
    <span class="breadcrumb-separator">></span>
    <span class="breadcrumb-item">Vista General</span>
  </nav>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="loading-spinner"></div>
    <p>Sincronizando datos en tiempo real...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-state">
    <div class="error-icon">‚ö†Ô∏è</div>
    <h3>Error de Conexi√≥n</h3>
    <p>{{ error }}</p>
    <button class="btn-primary" (click)="refreshData()">Reintentar</button>
  </div>

  <!-- Dashboard Content -->
  <div *ngIf="quickStats && !loading" class="dashboard-content">
    
    <!-- Quick Stats Cards con Gradientes -->
    <div class="quick-stats-section">
      <h2>Resumen en Tiempo Real</h2>
      <div class="stats-grid">
        <div class="stat-card gradient-blue">
          <div class="stat-header">
            <div class="stat-icon">üìû</div>
            <div class="stat-trend up">+{{ quickStats.callsChangePercentage }}%</div>
          </div>
          <div class="stat-content">
            <h3>{{ quickStats.totalCallsToday }}</h3>
            <p>Total Llamadas del D√≠a</p>
            <div class="stat-footer">
              <span class="stat-detail">Meta: {{ quickStats.totalDailyGoal }}</span>
            </div>
          </div>
        </div>

        <div class="stat-card gradient-green">
          <div class="stat-header">
            <div class="stat-icon">üè¢</div>
            <div class="stat-badge">{{ quickStats.problematicSponsors }} alertas</div>
          </div>
          <div class="stat-content">
            <h3>{{ quickStats.activeSponsors }}</h3>
            <p>Sponsors Activos</p>
            <div class="stat-footer">
              <span class="stat-detail">3 sponsors monitoreados</span>
            </div>
          </div>
        </div>

        <div class="stat-card gradient-orange">
          <div class="stat-header">
            <div class="stat-icon">‚úÖ</div>
            <div class="progress-ring">
              <svg viewBox="0 0 36 36">
                <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" 
                      fill="none" stroke="#e5e7eb" stroke-width="3"/>
                <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" 
                      fill="none" stroke="#10b981" stroke-width="3" 
                      [style.stroke-dasharray]="quickStats.contactedPercentage + ', 100'"/>
              </svg>
            </div>
          </div>
          <div class="stat-content">
            <h3>{{ quickStats.contactedPercentage }}%</h3>
            <p>Contactados</p>
            <div class="stat-footer">
              <span class="stat-detail">De {{ quickStats.totalCallsToday }} llamadas</span>
            </div>
          </div>
        </div>

        <div class="stat-card gradient-purple">
          <div class="stat-header">
            <div class="stat-icon">üéØ</div>
            <div class="progress-bar">
              <div class="progress-fill" [style.width]="quickStats.goalProgressPercentage + '%'"></div>
            </div>
          </div>
          <div class="stat-content">
            <h3>{{ quickStats.goalProgressPercentage }}%</h3>
            <p>Avance hacia Meta</p>
            <div class="stat-footer">
              <span class="stat-detail">{{ quickStats.totalCallsToday }}/{{ quickStats.totalDailyGoal }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Warnings Section -->
    <div class="warnings-section" *ngIf="quickStats.hasSyncIssues">
      <div class="warning-header" (click)="toggleWarnings()">
        <h3>‚ö†Ô∏è Alertas del Sistema</h3>
        <button class="toggle-btn">{{ showWarnings ? '‚ñº' : '‚ñ∂' }}</button>
      </div>
      <div class="warning-content" *ngIf="showWarnings">
        <div class="warning-item">
          <span class="warning-icon">üîÑ</span>
          <span class="warning-text">Sincronizaci√≥n retrasada - √öltima actualizaci√≥n hace {{ quickStats.minutesSinceLastSync }} minutos</span>
          <button class="warning-action">Resolver</button>
        </div>
      </div>
    </div>

    <!-- Tabs Navigation -->
    <div class="tabs-section">
      <div class="tabs-header">
        <button class="tab-btn" 
                [class.active]="activeTab === 'llamadas'" 
                (click)="setActiveTab('llamadas')">
          üìû Llamadas por Fecha
        </button>
        <button class="tab-btn" 
                [class.active]="activeTab === 'rendimiento'" 
                (click)="setActiveTab('rendimiento')">
          üìä Rendimiento y M√©tricas
        </button>
      </div>

      <!-- Tab Content: Llamadas -->
      <div class="tab-content" *ngIf="activeTab === 'llamadas'">
        <div class="content-header">
          <h3>An√°lisis de Llamadas</h3>
          <div class="content-actions">
            <button class="btn-outline">üì• Exportar</button>
            <button class="btn-outline">üìä Gr√°fico</button>
          </div>
        </div>

        <div class="charts-grid">
          <!-- Gr√°fico de Llamadas por Sponsor -->
          <div class="chart-card">
            <div class="chart-header">
              <h4>Llamadas por Sponsor</h4>
              <span class="chart-subtitle">Datos del d√≠a actual</span>
            </div>
            <highcharts-chart 
              [Highcharts]="Highcharts"
              [options]="callsChartOptions"
              class="chart-container">
            </highcharts-chart>
          </div>
          
          <!-- Gr√°fico de Progreso Circular -->
          <div class="chart-card">
            <div class="chart-header">
              <h4>Progreso de Metas</h4>
              <span class="chart-subtitle">% de cumplimiento</span>
            </div>
            <highcharts-chart 
              [Highcharts]="Highcharts"
              [options]="progressChartOptions"
              class="chart-container">
            </highcharts-chart>
          </div>
        </div>
        
        <!-- Tabla de Sponsors Mejorada -->
        <div class="sponsors-table">
          <div class="table-header">
            <h4>Detalle por Sponsor</h4>
            <span class="table-subtitle">Click para ver detalle de ejecutivos</span>
          </div>
          
          <div class="sponsor-row" *ngFor="let sponsor of quickStats.sponsorBreakdown">
            <div class="sponsor-card-enhanced" (click)="drillDownSponsor(sponsor)">
              <div class="sponsor-left">
                <div class="sponsor-indicator" [style.background-color]="getStatusColor(sponsor)"></div>
                <div class="sponsor-info">
                  <h4>{{ sponsor.sponsorName }}</h4>
                  <p>{{ sponsor.activeExecutives }} ejecutivos activos</p>
                </div>
              </div>
              <div class="sponsor-metrics">
                <div class="metric">
                  <span class="metric-label">Llamadas Hoy</span>
                  <span class="metric-value">{{ sponsor.callsToday }}</span>
                </div>
                <div class="metric">
                  <span class="metric-label">Meta</span>
                  <span class="metric-value">{{ sponsor.dailyGoal }}</span>
                </div>
                <div class="metric">
                  <span class="metric-label">Progreso</span>
                  <span class="metric-value">{{ sponsor.goalPercentage }}%</span>
                </div>
              </div>
              <div class="sponsor-right">
                <div class="progress-circle" [attr.data-progress]="sponsor.goalPercentage">
                  <svg viewBox="0 0 36 36">
                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" 
                          fill="none" stroke="#e5e7eb" stroke-width="2"/>
                    <path d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" 
                          fill="none" [attr.stroke]="getStatusColor(sponsor)" stroke-width="2" 
                          [style.stroke-dasharray]="sponsor.goalPercentage + ', 100'"/>
                  </svg>
                  <span class="progress-text">{{ sponsor.goalPercentage }}%</span>
                </div>
                <button class="drill-btn">‚Üí</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab Content: Rendimiento -->
      <div class="tab-content" *ngIf="activeTab === 'rendimiento'">
        <div class="content-header">
          <h3>M√©tricas de Rendimiento</h3>
          <div class="content-actions">
            <button class="btn-outline">üìà Dashboard</button>
            <button class="btn-outline">üìã Reporte</button>
          </div>
        </div>
        
        <div class="performance-section">
          <!-- Gr√°fico de Tendencia -->
          <div class="chart-card-large">
            <div class="chart-header">
              <h4>Tendencia de Llamadas</h4>
              <span class="chart-subtitle">√öltimos 7 d√≠as por sponsor</span>
            </div>
            <highcharts-chart 
              [Highcharts]="Highcharts"
              [options]="performanceChartOptions"
              class="chart-container">
            </highcharts-chart>
          </div>
          
          <!-- M√©tricas de Rendimiento -->
          <div class="performance-grid">
            <div class="performance-card">
              <div class="performance-header">
                <h4>Ejecutivos Activos</h4>
                <span class="performance-icon">üë•</span>
              </div>
              <div class="performance-value">{{ quickStats.totalActiveExecutives }}</div>
              <div class="performance-detail">
                Promedio: {{ quickStats.averageCallsPerExecutive | number:'1.1-1' }} llamadas/ejecutivo
              </div>
              <div class="performance-trend">
                <span class="trend-indicator positive">‚Üó +5.2%</span>
                <span class="trend-text">vs. semana anterior</span>
              </div>
            </div>
            
            <div class="performance-card">
              <div class="performance-header">
                <h4>Tasa de Contacto</h4>
                <span class="performance-icon">üìû</span>
              </div>
              <div class="performance-value">{{ quickStats.contactedPercentage }}%</div>
              <div class="performance-detail">
                {{ quickStats.totalCallsToday }} contactos exitosos
              </div>
              <div class="performance-trend">
                <span class="trend-indicator positive">‚Üó +2.1%</span>
                <span class="trend-text">vs. d√≠a anterior</span>
              </div>
            </div>

            <div class="performance-card">
              <div class="performance-header">
                <h4>Eficiencia Global</h4>
                <span class="performance-icon">‚ö°</span>
              </div>
              <div class="performance-value">92.3%</div>
              <div class="performance-detail">
                Sistema funcionando √≥ptimamente
              </div>
              <div class="performance-trend">
                <span class="trend-indicator positive">‚Üó +1.8%</span>
                <span class="trend-text">mejora continua</span>
              </div>
            </div>

            <div class="performance-card">
              <div class="performance-header">
                <h4>Sincronizaci√≥n</h4>
                <span class="performance-icon">üîÑ</span>
              </div>
              <div class="performance-value">99.8%</div>
              <div class="performance-detail">
                Datos actualizados en tiempo real
              </div>
              <div class="performance-trend">
                <span class="trend-indicator stable">‚Üí Estable</span>
                <span class="trend-text">sin errores</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- System Status Footer -->
    <div class="system-status-footer">
      <div class="status-left">
        <span class="status-indicator" 
              [style.background-color]="quickStats.systemStatus === 0 ? '#10B981' : 
                                       quickStats.systemStatus === 1 ? '#F59E0B' : 
                                       quickStats.systemStatus === 2 ? '#EF4444' : '#6B7280'">
        </span>
        <span class="status-text">Sistema {{ getSystemStatusText(quickStats.systemStatus) }}</span>
      </div>
      <div class="status-right">
        <span class="last-update">√öltima actualizaci√≥n: {{ quickStats.lastUpdateTimestamp | date:'short' }}</span>
        <span class="sync-info">Pr√≥xima sync en 2 minutos</span>
      </div>
    </div>

  </div>
</div>